---
layout: post
title: 每周工作总结：2016年2月8日
date: 2016-02-08
comments: true
category: Weekly Reflection
tags: reflection
keywords: Weekly Reflection

---

## 2016年02月08日

我今天感觉到自己的工作并没有计划性，基本上还是hacking的方式在开发。这样并不好，因为任何人都无法预期我的工作什么时候能完成，只是凭感觉觉得这样做不好。我从明天开始需要对工作做一个大致的规划，并且要跟踪执行过程中出现的异常情况。

我不知道是否可以利用工作时间去学习工作中需要用到的技术。

## 2016年02月09日

今天碰到了一个比较奇怪的技术问题：在Python里通过subprocess.call去执行rsync的时候，传入的路径总是被添加一个当前路径，导致传入的路径被修改成错误的路径，进而导致失败。例如：

```python
subprocess.call(["rsync", "-r", "user@10.11.12.13:~/Desktop/Data", "~/Target"])
```

如果我当前的Python脚本在```/home/ywen/code/```执行的话，那么目标路径就会被自动展开成```/home/ywen/code/~/Target```，导致rsync执行失败。

我一开始以为是Python的问题，于是花了很多时间上网查找资料。虽然有很多人也问了在Python中调用rsync的问题，但别人碰到的问题和我碰到的问题并不一样，并没有解决方案。我甚至写了一个非常简单的Python脚本去复现问题，并且放在IDE里面调试跟踪代码，但仍然没有直接找到原因。

不过，这次调试还是给了我提示。在不断跟踪subprocess.call()的内部代码的时候，我注意到call()方法的第一个参数，也即那个list，是被无差别传入到下层的代码的。也就是说，Python是不可能知道list中哪个元素是路径字符串然后在其前面添加当前路径的。

想到了这一点，我就知道问题应该不是出在Python上，而是很有可能出在rsync上。于是开始认真学习rsync的各个参数，试图找到一些蛛丝马迹。可是真正的线索出现在我尝试着使用这个命令的时候。那时我在命令行上输入：

	rsync -r ~/Source-

输入完之后，我按下了tab键试图让路径自动补全，但突然意外地发现rsync把前面的```~```自动展开成```/home/ywen/```了。于是我意识到或许这里必须想办法转成绝对路径。于是我使用了Python的os.path.expanduser()方法把目标路径中的```~```进行展开，就解决问题了。

明天还要去尝试一下：用别的命令，比如```cd```是否会对路径进行展开。另外我的Mac笔记本上的rsync并没有对路径进行展开，不知道是不是和rsync的版本还有关系。

不过，现在也的确更深刻地体会到：源码面前了无秘密。碰到问题了，去看看源代码，或许就可以找到解决问题的线索了。